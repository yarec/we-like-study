<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" style="overflow:hidden;">
<head>
    <meta http-equiv=content-type content="text/html; charset=UTF-8">
    
    
    <script src="../libs/jquery-1.3.2.min.js" type="text/javascript"></script>
    <!-- script src="../libs/openlayers/lib/OpenLayers.js" type="text/javascript"></script -->
    <script src="../libs/openlayers/OpenLayers.js" type="text/javascript"></script>
    <script src="../libs/kekscom-osmbuildings-d0cf7bd/dist/OpenLayers.Layer.Buildings-debug.js" type="text/javascript"></script>
    
<script type="text/javascript">
var map;

     function init() {
         
         $.ajax({
             url: "http://localhost:81/php/myapp.php?class=community_building&function=grid"
             ,dataType: 'json'
             ,type: "POST"
             ,data: {
                 a:1
             }        
             ,success : function(response) {
                
            	 /*
                 map = new OpenLayers.Map({
                     div: "map",
                     //allOverlays: true,
                     //resolutions: [0.703125, 0.3515625, 0.17578125, 0.087890625, 0.0439453125, 0.02197265625, 0.010986328125, 0.0054931640625, 0.00274658203125, 0.001373291015625, 6.866455078125E-4, 3.4332275390625E-4, 1.71661376953125E-4, 8.58306884765625E-5, 4.291534423828125E-5, 2.1457672119140625E-5, 1.0728836059570312E-5, 5.364418029785156E-6, 2.682209014892578E-6, 1.341104507446289E-6, 6.705522537231445E-7, 3.3527612686157227E-7, 1.6763806343078613E-7, 8.381903171539307E-8, 4.190951585769653E-8, 2.0954757928848267E-8],
                     projection: new OpenLayers.Projection('EPSG:4326'),
                     maxExtent: new OpenLayers.Bounds(0,0.0,180.0,90.0)

                 });
            	 */
                 
                 var map = new OpenLayers.Map('map');
                 map.addControl(new OpenLayers.Control.LayerSwitcher());                 
                 
                 var osm = new OpenLayers.Layer.OSM();
                 map.addLayer(osm);    
                 
                 map.setCenter(
                	        new OpenLayers.LonLat(13.33522, 52.50440)
                	            .transform(
                	                new OpenLayers.Projection('EPSG:4326'),
                	                map.getProjectionObject()
                	            ),
                	        17
                	    );
                	    var osmb = new OpenLayers.Layer.Buildings({ url: 'a.txt' });
                	    map.addLayer(osmb);return;                 
                 
                 var vectorLayer = new OpenLayers.Layer.Vector("图层");
                 //map.addLayer(vectorLayer);
                 for(var i=0;i<response.length;i++){
                	 //var vector = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.fromWKT(response[i].t));
                	 //vectorLayer.addFeatures([vector]);
                	 //console.debug(response[i].t);
                 }
                 //map.setCenter(new OpenLayers.LonLat(10,10),22);
                 map.setCenter(
                	        new OpenLayers.LonLat(13.33522, 52.50440)
                	            .transform(
                	                new OpenLayers.Projection('EPSG:4326'),
                	                map.getProjectionObject()
                	            ),
                	        17
                	    );                 
                 
                 var osmb = new OpenLayers.Layer.Buildings();
                 map.addLayer(osmb);

                     var geoJSONData = {
                     "type": "FeatureCollection",
                     "features": [{
                         "type": "Feature",
                         "geometry": {
                             "type": "Polygon",
                             "coordinates": [
                                 [
                                     [13.42634, 52.49533, 50],
                                     [13.42660, 52.49524, 50],
                                     [13.42619, 52.49483, 50],
                                     [13.42583, 52.49495, 50],
                                     [13.42590, 52.49501, 50],
                                     [13.42611, 52.49494, 50],
                                     [13.42640, 52.49525, 50],
                                     [13.42630, 52.49529, 50],
                                     [13.42634, 52.49533, 50]
                                 ]
                             ]
                         },
                         "properties": {
                             "color": "rgb(255,200,150)"
                         }
                     }, {
                         "type": "Feature",
                         "geometry": {
                             "type": "Polygon",
                             "coordinates": [
                                 [
                                     [13.42706, 52.49535],
                                     [13.42675, 52.49503],
                                     [13.42694, 52.49496],
                                     [13.42678, 52.49480],
                                     [13.42657, 52.49486],
                                     [13.42650, 52.49478],
                                     [13.42686, 52.49466],
                                     [13.42714, 52.49494],
                                     [13.42692, 52.49501],
                                     [13.42717, 52.49525],
                                     [13.42741, 52.49516],
                                     [13.42745, 52.49520],
                                     [13.42745, 52.49520],
                                     [13.42706, 52.49535]
                                 ]
                             ]
                         },
                         "properties": {
                             "height": 30,
                             "color": "rgb(180,240,180)"
                         }
                     }, {
                         "type": "Feature",
                         "geometry": {
                             "type": "MultiPolygon",
                             "coordinates": [
                                 [
                                     [
                                         [13.42746, 52.49440, 20],
                                         [13.42794, 52.49494, 20],
                                         [13.42799, 52.49492, 20],
                                         [13.42755, 52.49442, 20],
                                         [13.42798, 52.49428, 20],
                                         [13.42846, 52.49480, 20],
                                         [13.42851, 52.49478, 20],
                                         [13.42800, 52.49422, 20],
                                         [13.42746, 52.49440, 20]
                                     ]
                                 ],
                                 [
                                     [
                                         [13.42803, 52.49497, 30],
                                         [13.42800, 52.49493, 30],
                                         [13.42844, 52.49479, 30],
                                         [13.42847, 52.49483, 30],
                                         [13.42803, 52.49497, 30]
                                     ]
                                 ]
                             ]
                         },
                         "properties": {
                             "color": "rgb(200,200,250)"
                         }
                     }, {
                         "type": "Feature",
                         "geometry": {
                             "type": "Polygon",
                             "coordinates": [
                                 [
                                     [13.42857, 52.49480, 40],
                                     [13.42853, 52.49476, 40],
                                     [13.42863, 52.49473, 40],
                                     [13.42821, 52.49428, 40],
                                     [13.42837, 52.49423, 40],
                                     [13.42882, 52.49469, 40],
                                     [13.42896, 52.49465, 40],
                                     [13.42850, 52.49419, 40],
                                     [13.42867, 52.49412, 40],
                                     [13.42918, 52.49465, 40],
                                     [13.42857, 52.49480, 40]
                                 ]
                             ]
                         },
                         "properties": {
                             "color": "rgb(150,180,210)"
                         }
                     }]
                 };

                 osmb.geoJSON(geoJSONData);
                 
                 
             }
             ,error : function(){                
                 
             }
         });    
         

     }            

</script>

</head>
<body onload="init()">


<div id="map" style="width:99%;height:500px;"></div>
</body>

</html>